document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));const carrito={idusuario:0,productos:[]};function iniciarApp(){consultarApi(),esconder(),actuar(),mostrarCarrito(),idusuario(),hacerResumen()}function idusuario(){carrito.idusuario=document.querySelector("#idusuario").value}async function consultarApi(){try{const t="http://localhost:3000/api/productos",o=await fetch(t);mostrarProductos(await o.json())}catch(t){console.log(t)}}function mostrarProductos(t){t.forEach(t=>{const{id:o,nombre:e,descripcion:a,precio:r,stock:n,imagen_url:c,cantidad:i}=t,d=document.createElement("img");d.classList.add("imagen-producto"),d.src=`/img/productos/${c}.png`;const s=document.createElement("p");s.classList.add("nombre-producto"),s.textContent=e;const u=document.createElement("p");u.classList.add("precio-producto"),u.textContent="$ "+r;const l=document.createElement("button");l.classList.add("boton-producto"),l.dataset.idProducto=o,l.textContent="Agregar al carrito",l.onclick=function(){addCarrito(t)};const p=document.createElement("div");p.classList.add("producto"),p.appendChild(d),p.appendChild(s),p.appendChild(u),p.appendChild(l),document.querySelector("#productos").appendChild(p)})}function addCarrito(t){const{id:o}=t;let{productos:e}=carrito;e.some(t=>t.id===o)?t.cantidad+=1:carrito.productos=[...e,t],localStorage.setItem("carrito",JSON.stringify(carrito))}function mostrarCarrito(){const t=JSON.parse(localStorage.getItem("carrito")),o=document.querySelector("#carro");if(null===t)o.innerHTML="no se a seleccionado ningun producto";else{const{productos:e}=t;let a=0,r=0;if(0===t.length)o.innerHTML="no se a seleccionado ningun producto";else{o.innerHTML="",e.forEach(o=>{const{id:e,nombre:n,descripcion:c,precio:i,stock:d,imagen_url:s,cantidad:u}=o,l=document.createElement("img");l.classList.add("carrito-imagen"),l.src=`/img/productos/${s}.png`;const p=document.createElement("p");p.classList.add("carrito-nombre"),p.textContent=n,r=i*u;const m=document.createElement("p");m.classList.add("carrito-precio"),m.textContent=r;const g=document.createElement("input");g.classList.add("carrito-cantidad-input"),g.type="number",g.min=1,g.value=u,g.setAttribute("data-product-id",e),g.addEventListener("change",(function(){const o=this.getAttribute("data-product-id"),e=parseInt(this.value,10);if(e>=1){const a=t.productos.find(t=>t.id===o);a&&(a.cantidad=e,localStorage.setItem("carrito",JSON.stringify(t)),mostrarCarrito())}else this.value=1}));const f=document.createElement("button");f.classList.add("carrito-eliminar"),f.textContent="Eliminar",f.setAttribute("data-product-id",e),f.addEventListener("click",(function(){const o=this.getAttribute("data-product-id");t.productos=t.productos.filter(t=>t.id!==o),localStorage.setItem("carrito",JSON.stringify(t)),mostrarCarrito()}));const h=document.createElement("div");h.classList.add("carrito"),h.appendChild(l),h.appendChild(p),h.appendChild(g),h.appendChild(m),h.appendChild(f),document.querySelector("#carro").appendChild(h),a=r+a});const n=document.createElement("p");n.classList.add("carrito-cantidad"),n.textContent="el total del carrito es $ "+a,document.querySelector("#carro").appendChild(n)}}}function esconder(){document.querySelector("#cart").classList.toggle("hidden")}function actuar(){esconder(),mostrarCarrito()}async function guardarCarrito(){const t=JSON.parse(localStorage.getItem("carrito")),{productos:o}=t,e=o.map(t=>t.id),a=o.map(t=>t.cantidad),r=new FormData;r.append("usuario_id",carrito.idusuario),r.append("producto_id",e),r.append("cantidad",a);const n=await fetch("/api/carrito",{method:"POST",body:r});await n.json();window.location.href="/paginas/pedido"}function limpiar(){JSON.parse(localStorage.getItem("carrito")).productos=[],localStorage.removeItem("carrito"),mostrarCarrito()}function borrarCarro(){localStorage.clear()}function alInicio(){window.location.href="/",limpiar()}document.addEventListener("DOMContentLoaded",(function(){document.getElementById("detalles").addEventListener("click",(function(){window.location.href="/paginas/detalles"}))}));
//# sourceMappingURL=bundle.js.map
